
# Credential Stuffing
Credential stuffing is *injecting credentials from breaches into inputs to see if we can gain access*. It is *the most common exploit* found in pen-tests.
## Real Life Example
> [!WARNING]
> **DO NOT FOLLOW ALONG, IT'S ILLEGAL**
### Tesla Credentials from [Breach-Parse](/cybersecurity/tools/recon/breach-parse.md)
You can use breach parse (talked about in the breached credentials notes) to get a list of credentials from breaches. Breach-parse returns the results broken down into three files: a master list of everything, a password list, and a username list.
### Foxy Proxy
[Foxy Proxy](https://getfoxyproxy.org/) is a browser addon which makes it easy to use [proxy](/www/proxy.md) tools like 
[Burp Suite](/cybersecurity/tools/delivery/burp-suite.md).
#### Quick Setup:
1. Install the *Standard* version as Firefox extension
2. Pin to tool bar
3. Click icon --> options
4. `Title`: 'Burp'
5. `Proxy Type`: HTTP
6. `Proxy IP address`: 127.0.0.1
7. `Port`: 8080
8. Save
Now you can turn this proxy on or off from the extension toolbar icon.
### Burp Suite
Test the new proxy using Burp. Make sure *intercept is on* and your proxy settings are set to `127.0.0.1:8080`. Once you refresh the browser page, you should see output in the `Proxy` tab of burp suite.
### Tesla login page
Now that the proxy is on, find a login page for the `tesla domain`. Once you've found an endpoint, make sure intercept is on, enter fake credentials into the form. Then hit `sign in`.

With intercept on, you should see output in Burp Suite. Burp has captured the http traffic, paused it, and will allow you to step through the requests and responses sort of like a debugger.

Right click the output and select `send to intruder`.
### Intruder tab
Go to the intruder tab once you've sent it the HTTP data you captured using the proxy. Open the `Positions` sub tab, then click `Clear $` which will get rid of the positions Burp Suite is auto-suggesting...

These positions are positions *which we can potentially insert payloads into*, in our request to Tesla when we hit the sign in button.
#### Find the user and password fields in the request:
They likely look something like this:
```HTTP
&user=userteststring ...
&password=passwordteststring ...
```
Highlight the string values separately (the ones you entered into the form) and then click `Add ยง` on the right. This tells Burp Suite that this is where you want to inject your payload.
#### Attack type
Since we're attacking both the password and the username at the same time, we want our `Attack type` to be `Pitchfork` rather than the default `Sniper` (which only attacks one parameter).
#### `Payload` Sub Tab
Now that you've set the parameters in the request you want to attack, go to the `Payloads` sub tab. Copy the username list from your tesla username text document and paste it into the `Payload settings [Simple list]` form. Select `2` from the `Payload set` dropdown. Paste the list of passwords into here.

*Payload set 1* will be attacking the first parameter we added (should be username) in the HTTP request. 

*Payload set 2* will be attacking the second parameter (password) in the HTTP request.

Breach-Parse gives us a username list and a password list and the usernames *correspond to the password in the same position of the list* in the password list. This means that Burp will use the 1st username and the 1st password in the respective set to fill the parameters in the HTTP request it fabricates to send in the attack.
### Attack
> [!WARNING]
> **DO NOT USE THIS AGAINST AN ACTUAL SITE
> PEN-TESTING W/O AUTHORIZATION IS ILLEGAL
> THIS IS FOR EDUCATIONAL PURPOSES ONLY**

Now that our parameters and test values are set, we can click the `Start Attack` button. The attack will show you output which includes details about the tests payload, and the website's response. You can see the payload used (username and password), the [HTTP](/www/HTTP.md) status returned (ex: `200 OK`), any errors or timeouts, the length of the response, etc..

While it's printing out, *pay attention to changes in the status codes and length*. A larger response length can indicate that one of the payloads worked and/ or we received a response *other than the standard* yes/ no type we're expecting (w/ possibly more divulged informational findings).
#### BONUS Tip: Grep Match
If you pause the attack and look at the raw responses in the for each payload (click the payload to see). Find a string in the response (likely the HTML) (such as `"we could not sign you in"`) copy it, and then go to the `Options` tab.

In this tab you can use the string you copied to grep through the responses. Add the string into the `Grep Match` form. Once you restart the attack, a new column in the output will appear which tells you if that string is in the response. If the string was something like `"we could not sign you in"`, then for every payload which doesn't work, we'll see that the string was found in the output.

> [!Resources]
> - [Foxy Proxy](https://getfoxyproxy.org/)

> [!My previous notes (linked in text)]
> - [Heath Adams: Breach-parse](https://github.com/TrshPuppy/obsidian-notes/blob/main/cybersecurity/tools/recon/breach-parse.md)
> - [Proxies](https://github.com/TrshPuppy/obsidian-notes/blob/main/www/proxy.md)
> - [Burp Suite](https://github.com/TrshPuppy/obsidian-notes/blob/main/cybersecurity/tools/delivery/burp-suite.md)



